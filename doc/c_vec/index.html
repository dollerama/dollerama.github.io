<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Library to interface with chunks of memory allocated in C."><meta name="keywords" content="rust, rustlang, rust-lang, c_vec"><title>c_vec - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-93196c7a1c3542a8.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-4743e13df3dfe8c4.css"><link rel="stylesheet" disabled href="../static.files/dark-0e1b889528bd466b.css"><link rel="stylesheet" disabled href="../static.files/ayu-65289d5d067c7c66.css"><script id="default-settings" ></script><script src="../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../c_vec/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../c_vec/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate c_vec</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 2.0.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">c_vec</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/c_vec/lib.rs.html#10-238">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Library to interface with chunks of memory allocated in C.</p>
<p>It is often desirable to safely interface with memory allocated from C,
encapsulating the unsafety into allocation and destruction time.  Indeed,
allocating memory externally is currently the only way to give Rust shared
mut state with C programs that keep their own references; vectors are
unsuitable because they could be reallocated or moved at any time, and
importing C memory into a vector takes a one-time snapshot of the memory.</p>
<p>This module simplifies the usage of such external blocks of memory.  Memory
is encapsulated into an opaque object after creation; the lifecycle of the
memory can be optionally managed by Rust, if an appropriate destructor
closure is provided.  Safety is ensured by bounds-checking accesses, which
are marshalled through get and set functions.</p>
<p>There are three unsafe functions: the two constructors, and the
unwrapping method. The constructors are unsafe for the
obvious reason (they act on a pointer that cannot be checked inside the
method), but <code>into_inner()</code> is somewhat more subtle in its unsafety.
It returns the contained pointer, but at the same time destroys the CVec
without running its destructor. This can be used to pass memory back to
C, but care must be taken that the ownership of underlying resources are
handled correctly, i.e. that allocated memory is eventually freed
if necessary.</p>
<h2 id="example"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>c_vec::CVec;

<span class="kw">let </span>slice = <span class="kw-2">&amp;mut </span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];
<span class="kw">let </span>ptr = slice.as_mut_ptr();
<span class="kw">let </span>cvec = <span class="kw">unsafe </span>{ CVec::new(ptr, slice.len()) };
<span class="kw">for </span>elem <span class="kw">in </span>cvec.iter() {
    <span class="macro">println!</span>(<span class="string">&quot;=&gt; {}&quot;</span>, elem);
}</code></pre></div>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CSlice.html" title="c_vec::CSlice struct">CSlice</a></div><div class="item-right docblock-short">The type representing an ‘unsafe’ non-mutable foreign chunk of memory.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CSliceIter.html" title="c_vec::CSliceIter struct">CSliceIter</a></div><div class="item-right docblock-short">Iterator over <a href="struct.CSlice.html" title="CSlice"><code>CSlice</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CSliceMut.html" title="c_vec::CSliceMut struct">CSliceMut</a></div><div class="item-right docblock-short">The type representing an ‘unsafe’ mutable foreign chunk of memory.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CSliceMutIter.html" title="c_vec::CSliceMutIter struct">CSliceMutIter</a></div><div class="item-right docblock-short">Iterator over <a href="struct.CSliceMut.html" title="CSliceMut"><code>CSliceMut</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CSliceMutIterMut.html" title="c_vec::CSliceMutIterMut struct">CSliceMutIterMut</a></div><div class="item-right docblock-short">Mutable iterator over <a href="struct.CSliceMut.html" title="CSliceMut"><code>CSliceMut</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CVec.html" title="c_vec::CVec struct">CVec</a></div><div class="item-right docblock-short">The type representing a foreign mutable chunk of memory.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CVecIter.html" title="c_vec::CVecIter struct">CVecIter</a></div><div class="item-right docblock-short">Iterator over <a href="struct.CVec.html" title="CVec"><code>CVec</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CVecIterMut.html" title="c_vec::CVecIterMut struct">CVecIterMut</a></div><div class="item-right docblock-short">Mutable iterator over <a href="struct.CVec.html" title="CVec"><code>CVec</code></a>.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="c_vec" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.2 (9eb3afe9e 2023-03-27)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-c3c521c753752a1a.js" data-settings-css="settings-08ddfdda51b8ee2e.css" ></div></body></html>